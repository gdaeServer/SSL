<?xml version="1.0" encoding="IBM437"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=IBM437" http-equiv="Content-Type" />

  <title>Class: Net::HTTP::Persistent</title>

  <link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

  <script src="../../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../../lib/bundler/vendor/net/http/persistent_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/bundler/vendor/net/http/persistent.rb">lib/bundler/vendor/net/http/persistent.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="../../Object.html">Object</a></p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">CLASS</span> <a href="Persistent/Error.html">Net::HTTP::Persistent::Error</a></li>
          
          <li><span class="type">CLASS</span> <a href="Persistent/SSLReuse.html">Net::HTTP::Persistent::SSLReuse</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-detect_idle_timeout">::detect_idle_timeout</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-ca_file-3D">#ca_file=</a></li>
          
          <li><a href="#method-i-can_retry-3F">#can_retry?</a></li>
          
          <li><a href="#method-i-cert-3D">#cert=</a></li>
          
          <li><a href="#method-i-cert_store-3D">#cert_store=</a></li>
          
          <li><a href="#method-i-certificate-3D">#certificate=</a></li>
          
          <li><a href="#method-i-connection_close-3F">#connection_close?</a></li>
          
          <li><a href="#method-i-connection_for">#connection_for</a></li>
          
          <li><a href="#method-i-connection_keep_alive-3F">#connection_keep_alive?</a></li>
          
          <li><a href="#method-i-error_message">#error_message</a></li>
          
          <li><a href="#method-i-escape">#escape</a></li>
          
          <li><a href="#method-i-expired-3F">#expired?</a></li>
          
          <li><a href="#method-i-finish">#finish</a></li>
          
          <li><a href="#method-i-http_version">#http_version</a></li>
          
          <li><a href="#method-i-idempotent-3F">#idempotent?</a></li>
          
          <li><a href="#method-i-key-3D">#key=</a></li>
          
          <li><a href="#method-i-normalize_uri">#normalize_uri</a></li>
          
          <li><a href="#method-i-pipeline">#pipeline</a></li>
          
          <li><a href="#method-i-private_key-3D">#private_key=</a></li>
          
          <li><a href="#method-i-proxy-3D">#proxy=</a></li>
          
          <li><a href="#method-i-proxy_bypass-3F">#proxy_bypass?</a></li>
          
          <li><a href="#method-i-proxy_from_env">#proxy_from_env</a></li>
          
          <li><a href="#method-i-reconnect">#reconnect</a></li>
          
          <li><a href="#method-i-reconnect_ssl">#reconnect_ssl</a></li>
          
          <li><a href="#method-i-request">#request</a></li>
          
          <li><a href="#method-i-reset">#reset</a></li>
          
          <li><a href="#method-i-shutdown">#shutdown</a></li>
          
          <li><a href="#method-i-shutdown_in_all_threads">#shutdown_in_all_threads</a></li>
          
          <li><a href="#method-i-ssl">#ssl</a></li>
          
          <li><a href="#method-i-ssl_version-3D">#ssl_version=</a></li>
          
          <li><a href="#method-i-start">#start</a></li>
          
          <li><a href="#method-i-unescape">#unescape</a></li>
          
          <li><a href="#method-i-verify_callback-3D">#verify_callback=</a></li>
          
          <li><a href="#method-i-verify_mode-3D">#verify_mode=</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../../lib/bundler/man/bundle.html">bundle</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-config.html">bundle-config</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-config_txt.html">bundle-config.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-exec.html">bundle-exec</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-exec_txt.html">bundle-exec.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-install.html">bundle-install</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-install_txt.html">bundle-install.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-package.html">bundle-package</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-package_txt.html">bundle-package.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-platform.html">bundle-platform</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-platform_txt.html">bundle-platform.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-update.html">bundle-update</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle-update_txt.html">bundle-update.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/bundle_txt.html">bundle.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/man/gemfile_5_txt.html">gemfile.5.txt</a></li>
        
          <li class="file"><a href="../../lib/bundler/templates/Executable.html">Executable</a></li>
        
          <li class="file"><a href="../../lib/bundler/templates/Gemfile.html">Gemfile</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../Bundler.html">Bundler</a></li>
        
          <li><a href="../../Bundler/BundlerError.html">Bundler::BundlerError</a></li>
        
          <li><a href="../../Bundler/CLI.html">Bundler::CLI</a></li>
        
          <li><a href="../../Bundler/CLI/Binstubs.html">Bundler::CLI::Binstubs</a></li>
        
          <li><a href="../../Bundler/CLI/Cache.html">Bundler::CLI::Cache</a></li>
        
          <li><a href="../../Bundler/CLI/Check.html">Bundler::CLI::Check</a></li>
        
          <li><a href="../../Bundler/CLI/Clean.html">Bundler::CLI::Clean</a></li>
        
          <li><a href="../../Bundler/CLI/Common.html">Bundler::CLI::Common</a></li>
        
          <li><a href="../../Bundler/CLI/Config.html">Bundler::CLI::Config</a></li>
        
          <li><a href="../../Bundler/CLI/Console.html">Bundler::CLI::Console</a></li>
        
          <li><a href="../../Bundler/CLI/Exec.html">Bundler::CLI::Exec</a></li>
        
          <li><a href="../../Bundler/CLI/Gem.html">Bundler::CLI::Gem</a></li>
        
          <li><a href="../../Bundler/CLI/Init.html">Bundler::CLI::Init</a></li>
        
          <li><a href="../../Bundler/CLI/Inject.html">Bundler::CLI::Inject</a></li>
        
          <li><a href="../../Bundler/CLI/Install.html">Bundler::CLI::Install</a></li>
        
          <li><a href="../../Bundler/CLI/Lock.html">Bundler::CLI::Lock</a></li>
        
          <li><a href="../../Bundler/CLI/Open.html">Bundler::CLI::Open</a></li>
        
          <li><a href="../../Bundler/CLI/Outdated.html">Bundler::CLI::Outdated</a></li>
        
          <li><a href="../../Bundler/CLI/Package.html">Bundler::CLI::Package</a></li>
        
          <li><a href="../../Bundler/CLI/Platform.html">Bundler::CLI::Platform</a></li>
        
          <li><a href="../../Bundler/CLI/Show.html">Bundler::CLI::Show</a></li>
        
          <li><a href="../../Bundler/CLI/Update.html">Bundler::CLI::Update</a></li>
        
          <li><a href="../../Bundler/CLI/Viz.html">Bundler::CLI::Viz</a></li>
        
          <li><a href="../../Bundler/CurrentRuby.html">Bundler::CurrentRuby</a></li>
        
          <li><a href="../../Bundler/CyclicDependencyError.html">Bundler::CyclicDependencyError</a></li>
        
          <li><a href="../../Bundler/Definition.html">Bundler::Definition</a></li>
        
          <li><a href="../../Bundler/DepProxy.html">Bundler::DepProxy</a></li>
        
          <li><a href="../../Bundler/Dependency.html">Bundler::Dependency</a></li>
        
          <li><a href="../../Bundler/Deployment.html">Bundler::Deployment</a></li>
        
          <li><a href="../../Bundler/Deprecate.html">Bundler::Deprecate</a></li>
        
          <li><a href="../../Bundler/DeprecatedError.html">Bundler::DeprecatedError</a></li>
        
          <li><a href="../../Bundler/Dsl.html">Bundler::Dsl</a></li>
        
          <li><a href="../../Bundler/Dsl/DSLError.html">Bundler::Dsl::DSLError</a></li>
        
          <li><a href="../../Bundler/EndpointSpecification.html">Bundler::EndpointSpecification</a></li>
        
          <li><a href="../../Bundler/Env.html">Bundler::Env</a></li>
        
          <li><a href="../../Bundler/Environment.html">Bundler::Environment</a></li>
        
          <li><a href="../../Bundler/Fetcher.html">Bundler::Fetcher</a></li>
        
          <li><a href="../../Bundler/Fetcher/AuthenticationRequiredError.html">Bundler::Fetcher::AuthenticationRequiredError</a></li>
        
          <li><a href="../../Bundler/Fetcher/BadAuthenticationError.html">Bundler::Fetcher::BadAuthenticationError</a></li>
        
          <li><a href="../../Bundler/Fetcher/Base.html">Bundler::Fetcher::Base</a></li>
        
          <li><a href="../../Bundler/Fetcher/CertificateFailureError.html">Bundler::Fetcher::CertificateFailureError</a></li>
        
          <li><a href="../../Bundler/Fetcher/Dependency.html">Bundler::Fetcher::Dependency</a></li>
        
          <li><a href="../../Bundler/Fetcher/Downloader.html">Bundler::Fetcher::Downloader</a></li>
        
          <li><a href="../../Bundler/Fetcher/FallbackError.html">Bundler::Fetcher::FallbackError</a></li>
        
          <li><a href="../../Bundler/Fetcher/Index.html">Bundler::Fetcher::Index</a></li>
        
          <li><a href="../../Bundler/Fetcher/NetworkDownError.html">Bundler::Fetcher::NetworkDownError</a></li>
        
          <li><a href="../../Bundler/Fetcher/SSLError.html">Bundler::Fetcher::SSLError</a></li>
        
          <li><a href="../../Bundler/GemHelper.html">Bundler::GemHelper</a></li>
        
          <li><a href="../../Bundler/GemHelpers.html">Bundler::GemHelpers</a></li>
        
          <li><a href="../../Bundler/GemInstaller.html">Bundler::GemInstaller</a></li>
        
          <li><a href="../../Bundler/GemNotFound.html">Bundler::GemNotFound</a></li>
        
          <li><a href="../../Bundler/GemfileError.html">Bundler::GemfileError</a></li>
        
          <li><a href="../../Bundler/GemfileLockNotFound.html">Bundler::GemfileLockNotFound</a></li>
        
          <li><a href="../../Bundler/GemfileNotFound.html">Bundler::GemfileNotFound</a></li>
        
          <li><a href="../../Bundler/GemspecError.html">Bundler::GemspecError</a></li>
        
          <li><a href="../../Bundler/GitError.html">Bundler::GitError</a></li>
        
          <li><a href="../../Bundler/Graph.html">Bundler::Graph</a></li>
        
          <li><a href="../../Bundler/Graph/GraphVizClient.html">Bundler::Graph::GraphVizClient</a></li>
        
          <li><a href="../../Bundler/HTTPError.html">Bundler::HTTPError</a></li>
        
          <li><a href="../../Bundler/Index.html">Bundler::Index</a></li>
        
          <li><a href="../../Bundler/Injector.html">Bundler::Injector</a></li>
        
          <li><a href="../../Bundler/InstallError.html">Bundler::InstallError</a></li>
        
          <li><a href="../../Bundler/InstallHookError.html">Bundler::InstallHookError</a></li>
        
          <li><a href="../../Bundler/Installer.html">Bundler::Installer</a></li>
        
          <li><a href="../../Bundler/InvalidOption.html">Bundler::InvalidOption</a></li>
        
          <li><a href="../../Bundler/LazySpecification.html">Bundler::LazySpecification</a></li>
        
          <li><a href="../../Bundler/LockfileError.html">Bundler::LockfileError</a></li>
        
          <li><a href="../../Bundler/LockfileParser.html">Bundler::LockfileParser</a></li>
        
          <li><a href="../../Bundler/MarshalError.html">Bundler::MarshalError</a></li>
        
          <li><a href="../../Bundler/MatchPlatform.html">Bundler::MatchPlatform</a></li>
        
          <li><a href="../../Bundler/Molinillo.html">Bundler::Molinillo</a></li>
        
          <li><a href="../../Bundler/Molinillo/CircularDependencyError.html">Bundler::Molinillo::CircularDependencyError</a></li>
        
          <li><a href="../../Bundler/Molinillo/DependencyGraph.html">Bundler::Molinillo::DependencyGraph</a></li>
        
          <li><a href="../../Bundler/Molinillo/DependencyGraph/Vertex.html">Bundler::Molinillo::DependencyGraph::Vertex</a></li>
        
          <li><a href="../../Bundler/Molinillo/DependencyState.html">Bundler::Molinillo::DependencyState</a></li>
        
          <li><a href="../../Bundler/Molinillo/NoSuchDependencyError.html">Bundler::Molinillo::NoSuchDependencyError</a></li>
        
          <li><a href="../../Bundler/Molinillo/PossibilityState.html">Bundler::Molinillo::PossibilityState</a></li>
        
          <li><a href="../../Bundler/Molinillo/Resolver.html">Bundler::Molinillo::Resolver</a></li>
        
          <li><a href="../../Bundler/Molinillo/Resolver/Resolution.html">Bundler::Molinillo::Resolver::Resolution</a></li>
        
          <li><a href="../../Bundler/Molinillo/ResolverError.html">Bundler::Molinillo::ResolverError</a></li>
        
          <li><a href="../../Bundler/Molinillo/SpecificationProvider.html">Bundler::Molinillo::SpecificationProvider</a></li>
        
          <li><a href="../../Bundler/Molinillo/UI.html">Bundler::Molinillo::UI</a></li>
        
          <li><a href="../../Bundler/Molinillo/VersionConflict.html">Bundler::Molinillo::VersionConflict</a></li>
        
          <li><a href="../../Bundler/PathError.html">Bundler::PathError</a></li>
        
          <li><a href="../../Bundler/ProductionError.html">Bundler::ProductionError</a></li>
        
          <li><a href="../../Bundler/RemoteSpecification.html">Bundler::RemoteSpecification</a></li>
        
          <li><a href="../../Bundler/Resolver.html">Bundler::Resolver</a></li>
        
          <li><a href="../../Bundler/Resolver/Molinillo.html">Bundler::Resolver::Molinillo</a></li>
        
          <li><a href="../../Bundler/Resolver/Molinillo/VersionConflict.html">Bundler::Resolver::Molinillo::VersionConflict</a></li>
        
          <li><a href="../../Bundler/Resolver/SpecGroup.html">Bundler::Resolver::SpecGroup</a></li>
        
          <li><a href="../../Bundler/Retry.html">Bundler::Retry</a></li>
        
          <li><a href="../../Bundler/RubyDsl.html">Bundler::RubyDsl</a></li>
        
          <li><a href="../../Bundler/RubyVersion.html">Bundler::RubyVersion</a></li>
        
          <li><a href="../../Bundler/RubyVersionMismatch.html">Bundler::RubyVersionMismatch</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration.html">Bundler::RubygemsIntegration</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/AlmostModern.html">Bundler::RubygemsIntegration::AlmostModern</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/Ancient.html">Bundler::RubygemsIntegration::Ancient</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/Future.html">Bundler::RubygemsIntegration::Future</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/Gem.html">Bundler::RubygemsIntegration::Gem</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/Legacy.html">Bundler::RubygemsIntegration::Legacy</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/Legacy/Gem/SourceIndex.html">Bundler::RubygemsIntegration::Legacy::Gem::SourceIndex</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/Modern.html">Bundler::RubygemsIntegration::Modern</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/MoreFuture.html">Bundler::RubygemsIntegration::MoreFuture</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/MoreModern.html">Bundler::RubygemsIntegration::MoreModern</a></li>
        
          <li><a href="../../Bundler/RubygemsIntegration/Transitional.html">Bundler::RubygemsIntegration::Transitional</a></li>
        
          <li><a href="../../Bundler/Runtime.html">Bundler::Runtime</a></li>
        
          <li><a href="../../Bundler/SecurityError.html">Bundler::SecurityError</a></li>
        
          <li><a href="../../Bundler/Settings.html">Bundler::Settings</a></li>
        
          <li><a href="../../Bundler/SharedHelpers.html">Bundler::SharedHelpers</a></li>
        
          <li><a href="../../Bundler/SimilarityDetector.html">Bundler::SimilarityDetector</a></li>
        
          <li><a href="../../Bundler/Source.html">Bundler::Source</a></li>
        
          <li><a href="../../Bundler/Source/Git.html">Bundler::Source::Git</a></li>
        
          <li><a href="../../Bundler/Source/Git/GitCommandError.html">Bundler::Source::Git::GitCommandError</a></li>
        
          <li><a href="../../Bundler/Source/Git/GitNotAllowedError.html">Bundler::Source::Git::GitNotAllowedError</a></li>
        
          <li><a href="../../Bundler/Source/Git/GitNotInstalledError.html">Bundler::Source::Git::GitNotInstalledError</a></li>
        
          <li><a href="../../Bundler/Source/Git/GitProxy.html">Bundler::Source::Git::GitProxy</a></li>
        
          <li><a href="../../Bundler/Source/Path.html">Bundler::Source::Path</a></li>
        
          <li><a href="../../Bundler/Source/Path/Installer.html">Bundler::Source::Path::Installer</a></li>
        
          <li><a href="../../Bundler/Source/Rubygems.html">Bundler::Source::Rubygems</a></li>
        
          <li><a href="../../Bundler/Source/Rubygems/Remote.html">Bundler::Source::Rubygems::Remote</a></li>
        
          <li><a href="../../Bundler/SourceList.html">Bundler::SourceList</a></li>
        
          <li><a href="../../Bundler/SpecSet.html">Bundler::SpecSet</a></li>
        
          <li><a href="../../Bundler/StubSpecification.html">Bundler::StubSpecification</a></li>
        
          <li><a href="../../Bundler/SystemRubyVersion.html">Bundler::SystemRubyVersion</a></li>
        
          <li><a href="../../Bundler/Thor.html">Bundler::Thor</a></li>
        
          <li><a href="../../Bundler/Thor/Actions.html">Bundler::Thor::Actions</a></li>
        
          <li><a href="../../Bundler/Thor/Actions/ClassMethods.html">Bundler::Thor::Actions::ClassMethods</a></li>
        
          <li><a href="../../Bundler/Thor/AmbiguousCommandError.html">Bundler::Thor::AmbiguousCommandError</a></li>
        
          <li><a href="../../Bundler/Thor/Base.html">Bundler::Thor::Base</a></li>
        
          <li><a href="../../Bundler/Thor/Base/ClassMethods.html">Bundler::Thor::Base::ClassMethods</a></li>
        
          <li><a href="../../Bundler/Thor/Command.html">Bundler::Thor::Command</a></li>
        
          <li><a href="../../Bundler/Thor/DynamicCommand.html">Bundler::Thor::DynamicCommand</a></li>
        
          <li><a href="../../Bundler/Thor/Error.html">Bundler::Thor::Error</a></li>
        
          <li><a href="../../Bundler/Thor/Group.html">Bundler::Thor::Group</a></li>
        
          <li><a href="../../Bundler/Thor/HiddenCommand.html">Bundler::Thor::HiddenCommand</a></li>
        
          <li><a href="../../Bundler/Thor/Invocation.html">Bundler::Thor::Invocation</a></li>
        
          <li><a href="../../Bundler/Thor/Invocation/ClassMethods.html">Bundler::Thor::Invocation::ClassMethods</a></li>
        
          <li><a href="../../Bundler/Thor/InvocationError.html">Bundler::Thor::InvocationError</a></li>
        
          <li><a href="../../Bundler/Thor/LineEditor.html">Bundler::Thor::LineEditor</a></li>
        
          <li><a href="../../Bundler/Thor/LineEditor/Basic.html">Bundler::Thor::LineEditor::Basic</a></li>
        
          <li><a href="../../Bundler/Thor/LineEditor/Readline.html">Bundler::Thor::LineEditor::Readline</a></li>
        
          <li><a href="../../Bundler/Thor/LineEditor/Readline/PathCompletion.html">Bundler::Thor::LineEditor::Readline::PathCompletion</a></li>
        
          <li><a href="../../Bundler/Thor/MalformattedArgumentError.html">Bundler::Thor::MalformattedArgumentError</a></li>
        
          <li><a href="../../Bundler/Thor/RakeCompat.html">Bundler::Thor::RakeCompat</a></li>
        
          <li><a href="../../Bundler/Thor/RequiredArgumentMissingError.html">Bundler::Thor::RequiredArgumentMissingError</a></li>
        
          <li><a href="../../Bundler/Thor/Shell.html">Bundler::Thor::Shell</a></li>
        
          <li><a href="../../Bundler/Thor/Shell/Basic.html">Bundler::Thor::Shell::Basic</a></li>
        
          <li><a href="../../Bundler/Thor/Shell/Color.html">Bundler::Thor::Shell::Color</a></li>
        
          <li><a href="../../Bundler/Thor/Shell/HTML.html">Bundler::Thor::Shell::HTML</a></li>
        
          <li><a href="../../Bundler/Thor/UndefinedCommandError.html">Bundler::Thor::UndefinedCommandError</a></li>
        
          <li><a href="../../Bundler/Thor/UnknownArgumentError.html">Bundler::Thor::UnknownArgumentError</a></li>
        
          <li><a href="../../Bundler/Thor/Util.html">Bundler::Thor::Util</a></li>
        
          <li><a href="../../Bundler/UI.html">Bundler::UI</a></li>
        
          <li><a href="../../Bundler/UI/RGProxy.html">Bundler::UI::RGProxy</a></li>
        
          <li><a href="../../Bundler/UI/Shell.html">Bundler::UI::Shell</a></li>
        
          <li><a href="../../Bundler/UI/Silent.html">Bundler::UI::Silent</a></li>
        
          <li><a href="../../Bundler/VersionConflict.html">Bundler::VersionConflict</a></li>
        
          <li><a href="../../Bundler/Worker.html">Bundler::Worker</a></li>
        
          <li><a href="../../Bundler/Worker/WrappedException.html">Bundler::Worker::WrappedException</a></li>
        
          <li><a href="../../Gem.html">Gem</a></li>
        
          <li><a href="../../Gem/Dependency.html">Gem::Dependency</a></li>
        
          <li><a href="../../Gem/Platform.html">Gem::Platform</a></li>
        
          <li><a href="../../Gem/Requirement.html">Gem::Requirement</a></li>
        
          <li><a href="../../Gem/Specification.html">Gem::Specification</a></li>
        
          <li><a href="../../Net.html">Net</a></li>
        
          <li><a href="../../Net/HTTP.html">Net::HTTP</a></li>
        
          <li><a href="../../Net/HTTP/Persistent.html">Net::HTTP::Persistent</a></li>
        
          <li><a href="../../Net/HTTP/Persistent/Error.html">Net::HTTP::Persistent::Error</a></li>
        
          <li><a href="../../Net/HTTP/Persistent/SSLReuse.html">Net::HTTP::Persistent::SSLReuse</a></li>
        
          <li><a href="../../ParallelInstaller.html">ParallelInstaller</a></li>
        
          <li><a href="../../ParallelInstaller/SpecInstallation.html">ParallelInstaller::SpecInstallation</a></li>
        
          <li><a href="../../Object.html">Object</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Net::HTTP::Persistent</h1>

    <div id="description" class="description">
      
<p><a href="Persistent.html">Persistent</a> connections for <a
href="../HTTP.html">Net::HTTP</a></p>

<p><a href="Persistent.html">Net::HTTP::Persistent</a> maintains persistent
connections across all the servers you wish to talk to.  For each host:port
you communicate with a single persistent connection is created.</p>

<p>Multiple <a href="Persistent.html">Net::HTTP::Persistent</a> objects will
share the same set of connections.</p>

<p>For each thread you start a new connection will be created.  A <a
href="Persistent.html">Net::HTTP::Persistent</a> connection will not be
shared across threads.</p>

<p>You can shut down the <a href="../HTTP.html">HTTP</a> connections when done
by calling <a href="Persistent.html#method-i-shutdown">shutdown</a>.  You
should name your <a href="Persistent.html">Net::HTTP::Persistent</a> object
if you intend to call this method.</p>

<p>Example:</p>

<pre>require 'net/http/persistent'

uri = URI 'http://example.com/awesome/web/service'

http = Net::HTTP::Persistent.new 'my_app_name'

# perform a GET
response = http.request uri

# or

get = Net::HTTP::Get.new uri.request_uri
response = http.request get

# create a POST
post_uri = uri + 'create'
post = Net::HTTP::Post.new post_uri.path
post.set_form_data 'some' =&gt; 'cool data'

# perform the POST, the URI is always required
response http.request post_uri, post</pre>

<p>Note that for GET, HEAD and other requests that do not have a body you want
to use URI#request_uri not URI#path.  The request_uri contains the query
params which are sent in the body for other requests.</p>

<h2>SSL</h2>

<p>SSL connections are automatically created depending upon the scheme of the
URI.  SSL connections are automatically verified against the default
certificate store for your computer.  You can override this by changing <a
href="Persistent.html#attribute-i-verify_mode">verify_mode</a> or by
specifying an alternate cert_store.</p>

<p>Here are the SSL settings, see the individual methods for documentation:</p>
<table class="rdoc-list"><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-certificate">certificate</a>        </p></td>
<td>
<p>This client's certificate</p>
</td></tr><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-ca_file">ca_file</a>            </p></td>
<td>
<p>The certificate-authority</p>
</td></tr><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-cert_store">cert_store</a>         </p></td>
<td>
<p>An SSL certificate store</p>
</td></tr><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-private_key">private_key</a>        </p></td>
<td>
<p>The client's SSL private key</p>
</td></tr><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-reuse_ssl_sessions">reuse_ssl_sessions</a> </p></td>
<td>
<p>Reuse a previously opened SSL session for a new connection</p>
</td></tr><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-ssl_version">ssl_version</a>        </p></td>
<td>
<p>Which specific SSL version to use</p>
</td></tr><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-verify_callback">verify_callback</a>    </p></td>
<td>
<p>For server certificate verification</p>
</td></tr><tr><td class="rdoc-term"><p><a href="Persistent.html#attribute-i-verify_mode">verify_mode</a>        </p></td>
<td>
<p>How connections should be verified</p>
</td></tr></table>

<h2>Proxies</h2>

<p>A proxy can be set through <a
href="Persistent.html#method-i-proxy-3D">proxy=</a> or at initialization
time by providing a second argument to <a
href="Persistent.html#method-c-new">::new</a>.  The proxy may be the URI of
the proxy server or <tt>:ENV</tt> which will consult environment variables.</p>

<p>See <a href="Persistent.html#method-i-proxy-3D">proxy=</a> and <a
href="Persistent.html#method-i-proxy_from_env">proxy_from_env</a> for
details.</p>

<h2>Headers</h2>

<p>Headers may be specified for use in every request.  <a
href="Persistent.html#attribute-i-headers">headers</a> are appended to any
headers on the request.  <a
href="Persistent.html#attribute-i-override_headers">override_headers</a>
replace existing headers on the request.</p>

<p>The difference between the two can be seen in setting the User-Agent. 
Using <tt>http.headers['User-Agent'] = 'MyUserAgent'</tt> will send "Ruby,
MyUserAgent" while <tt>http.override_headers['User-Agent'] =
'MyUserAgent'</tt> will send "MyUserAgent".</p>

<h2>Tuning</h2>

<h3>Segregation</h3>

<p>By providing an application name to <a
href="Persistent.html#method-c-new">::new</a> you can separate your
connections from the connections of other applications.</p>

<h3>Idle Timeout</h3>

<p>If a connection hasn't been used for this number of seconds it will
automatically be reset upon the next use to avoid attempting to send to a
closed connection. The default value is 5 seconds. nil means no timeout.
Set through <a
href="Persistent.html#attribute-i-idle_timeout">idle_timeout</a>.</p>

<p>Reducing this value may help avoid the "too many connection resets" error
when sending non-idempotent requests while increasing this value will cause
fewer round-trips.</p>

<h3>Read Timeout</h3>

<p>The amount of time allowed between reading two chunks from the socket.  Set
through <a href="Persistent.html#attribute-i-read_timeout">read_timeout</a></p>

<h3>Max Requests</h3>

<p>The number of requests that should be made before opening a new connection.
Typically many keep-alive capable servers tune this to 100 or less, so the
101st request will fail with ECONNRESET. If unset (default), this value has
no effect, if set, connections will be reset on the request after
max_requests.</p>

<h3>Open Timeout</h3>

<p>The amount of time to wait for a connection to be opened.  Set through <a
href="Persistent.html#attribute-i-open_timeout">open_timeout</a>.</p>

<h3>Socket Options</h3>

<p>Socket options may be set on newly-created connections.  See <a
href="Persistent.html#attribute-i-socket_options">socket_options</a> for
details.</p>

<h3>Non-Idempotent Requests</h3>

<p>By default non-idempotent requests will not be retried per RFC 2616.  By
setting <a
href="Persistent.html#attribute-i-retry_change_requests">retry_change_requests</a>
to true requests will automatically be retried once.</p>

<p>Only do this when you know that retrying a POST or other non-idempotent
request is safe for your application and will not create duplicate
resources.</p>

<p>The recommended way to handle non-idempotent requests is the following:</p>

<pre>require 'net/http/persistent'

uri = URI 'http://example.com/awesome/web/service'
post_uri = uri + 'create'

http = Net::HTTP::Persistent.new 'my_app_name'

post = Net::HTTP::Post.new post_uri.path
# ... fill in POST request

begin
  response = http.request post_uri, post
rescue Net::HTTP::Persistent::Error

  # POST failed, make a new request to verify the server did not process
  # the request
  exists_uri = uri + '...'
  response = http.get exists_uri

  # Retry if it failed
  retry if response.code == '404'
end</pre>

<p>The method of determining if the resource was created or not is unique to
the particular service you are using.  Of course, you will want to add
protection from infinite looping.</p>

<h3>Connection Termination</h3>

<p>If you are done using the <a
href="Persistent.html">Net::HTTP::Persistent</a> instance you may shut down
all the connections in the current thread with <a
href="Persistent.html#method-i-shutdown">shutdown</a>.  This is not
recommended for normal use, it should only be used when it will be several
minutes before you make another <a href="../HTTP.html">HTTP</a> request.</p>

<p>If you are using multiple threads, call <a
href="Persistent.html#method-i-shutdown">shutdown</a> in each thread when
the thread is done making requests.  If you don't call shutdown, that's OK.
Ruby will automatically garbage collect and shutdown your <a
href="../HTTP.html">HTTP</a> connections when the thread terminates.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="detect_idle_timeout-method" class="method-detail ">
          <a name="method-c-detect_idle_timeout"></a>

          
          <div class="method-heading">
            <span class="method-name">detect_idle_timeout</span><span
              class="method-args">(uri, max = 10)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Use this method to detect the idle timeout of the host at <tt>uri</tt>. 
The value returned can be used to configure <a
href="Persistent.html#attribute-i-idle_timeout">idle_timeout</a>. 
<tt>max</tt> controls the maximum idle timeout to detect.</p>

<p>After</p>

<p>Idle timeout detection is performed by creating a connection then
performing a HEAD request in a loop until the connection terminates waiting
one additional second per loop.</p>

<p>NOTE:  This may not work on ruby &gt; 1.9.</p>
            

            
            <div class="method-source-code" id="detect_idle_timeout-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">detect_idle_timeout</span> <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">max</span> = <span class="ruby-value">10</span>
  <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span> <span class="ruby-identifier">uri</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">Generic</span>)
  <span class="ruby-identifier">uri</span> <span class="ruby-operator">+=</span> <span class="ruby-string">'/'</span>

  <span class="ruby-identifier">req</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Head</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">request_uri</span>

  <span class="ruby-identifier">http</span> = <span class="ruby-identifier">new</span> <span class="ruby-string">'net-http-persistent detect_idle_timeout'</span>

  <span class="ruby-identifier">connection</span> = <span class="ruby-identifier">http</span>.<span class="ruby-identifier">connection_for</span> <span class="ruby-identifier">uri</span>

  <span class="ruby-identifier">sleep_time</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">response</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span> <span class="ruby-identifier">req</span>

    <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;HEAD #{uri} =&gt; #{response.code}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPOK</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;bad response code #{response.code} detecting idle timeout&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">sleep_time</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">max</span>

    <span class="ruby-identifier">sleep_time</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>

    <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;sleeping #{sleep_time}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-identifier">sleep_time</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span>
  <span class="ruby-comment"># ignore StandardErrors, we've probably found the idle timeout.</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-identifier">http</span>.<span class="ruby-identifier">shutdown</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">sleep_time</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">$!</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- detect_idle_timeout-source -->
            
          </div>

          

          
        </div><!-- detect_idle_timeout-method -->

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(name = nil, proxy = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a new <a href="Persistent.html">Net::HTTP::Persistent</a>.</p>

<p>Set <tt>name</tt> to keep your connections apart from everybody else's. 
Not required currently, but highly recommended.  Your library name should
be good enough.  This parameter will be required in a future version.</p>

<p><tt>proxy</tt> may be set to a URI::HTTP or :ENV to pick up proxy options
from the environment.  See <a
href="Persistent.html#method-i-proxy_from_env">proxy_from_env</a> for
details.</p>

<p>In order to use a URI for the proxy you may need to do some extra work
beyond URI parsing if the proxy requires a password:</p>

<pre>proxy = URI 'http://proxy.example'
proxy.user     = 'AzureDiamond'
proxy.password = 'hunter2'</pre>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 482</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">name</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">proxy</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">name</span>

  <span class="ruby-ivar">@debug_output</span>     = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@proxy_uri</span>        = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@no_proxy</span>         = []
  <span class="ruby-ivar">@headers</span>          = {}
  <span class="ruby-ivar">@override_headers</span> = {}
  <span class="ruby-ivar">@http_versions</span>    = {}
  <span class="ruby-ivar">@keep_alive</span>       = <span class="ruby-value">30</span>
  <span class="ruby-ivar">@open_timeout</span>     = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@read_timeout</span>     = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@idle_timeout</span>     = <span class="ruby-value">5</span>
  <span class="ruby-ivar">@max_requests</span>     = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@socket_options</span>   = []

  <span class="ruby-ivar">@socket_options</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-constant">Socket</span><span class="ruby-operator">::</span><span class="ruby-constant">IPPROTO_TCP</span>, <span class="ruby-constant">Socket</span><span class="ruby-operator">::</span><span class="ruby-constant">TCP_NODELAY</span>, <span class="ruby-value">1</span>] <span class="ruby-keyword">if</span>
    <span class="ruby-constant">Socket</span>.<span class="ruby-identifier">const_defined?</span> <span class="ruby-value">:TCP_NODELAY</span>

  <span class="ruby-identifier">key</span> = [<span class="ruby-string">'net_http_persistent'</span>, <span class="ruby-identifier">name</span>].<span class="ruby-identifier">compact</span>
  <span class="ruby-ivar">@generation_key</span>     = [<span class="ruby-identifier">key</span>, <span class="ruby-string">'generations'</span>    ].<span class="ruby-identifier">join</span>(<span class="ruby-string">'_'</span>).<span class="ruby-identifier">intern</span>
  <span class="ruby-ivar">@ssl_generation_key</span> = [<span class="ruby-identifier">key</span>, <span class="ruby-string">'ssl_generations'</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">'_'</span>).<span class="ruby-identifier">intern</span>
  <span class="ruby-ivar">@request_key</span>        = [<span class="ruby-identifier">key</span>, <span class="ruby-string">'requests'</span>       ].<span class="ruby-identifier">join</span>(<span class="ruby-string">'_'</span>).<span class="ruby-identifier">intern</span>
  <span class="ruby-ivar">@timeout_key</span>        = [<span class="ruby-identifier">key</span>, <span class="ruby-string">'timeouts'</span>       ].<span class="ruby-identifier">join</span>(<span class="ruby-string">'_'</span>).<span class="ruby-identifier">intern</span>

  <span class="ruby-ivar">@certificate</span>        = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@ca_file</span>            = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@private_key</span>        = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@ssl_version</span>        = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@verify_callback</span>    = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@verify_mode</span>        = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@cert_store</span>         = <span class="ruby-keyword">nil</span>

  <span class="ruby-ivar">@generation</span>         = <span class="ruby-value">0</span> <span class="ruby-comment"># incremented when proxy URI changes</span>
  <span class="ruby-ivar">@ssl_generation</span>     = <span class="ruby-value">0</span> <span class="ruby-comment"># incremented when SSL session variables change</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">HAVE_OPENSSL</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@verify_mode</span>        = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_PEER</span>
    <span class="ruby-ivar">@reuse_ssl_sessions</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span>.<span class="ruby-identifier">const_defined?</span> <span class="ruby-value">:Session</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@retry_change_requests</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-ivar">@ruby_1</span> = <span class="ruby-constant">RUBY_VERSION</span> <span class="ruby-operator">&lt;</span> <span class="ruby-string">'2'</span>
  <span class="ruby-ivar">@retried_on_ruby_2</span> = <span class="ruby-operator">!</span><span class="ruby-ivar">@ruby_1</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">proxy</span> = <span class="ruby-identifier">proxy</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">proxy</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="ca_file-3D-method" class="method-detail ">
          <a name="method-i-ca_file-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">ca_file=</span><span
              class="method-args">(file)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the SSL certificate authority file.</p>
            

            
            <div class="method-source-code" id="ca_file-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 546</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ca_file=</span> <span class="ruby-identifier">file</span>
  <span class="ruby-ivar">@ca_file</span> = <span class="ruby-identifier">file</span>

  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- ca_file-3D-source -->
            
          </div>

          

          
        </div><!-- ca_file-3D-method -->

      
        <div id="can_retry-3F-method" class="method-detail ">
          <a name="method-i-can_retry-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">can_retry?</span><span
              class="method-args">(req, retried_on_ruby_2 = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Is the request <tt>req</tt> idempotent or is <a
href="Persistent.html#attribute-i-retry_change_requests">retry_change_requests</a>
allowed.</p>

<p>If <tt>retried_on_ruby_2</tt> is true, true will be returned if we are on
ruby, <a
href="Persistent.html#attribute-i-retry_change_requests">retry_change_requests</a>
is allowed and the request is not idempotent.</p>
            

            
            <div class="method-source-code" id="can_retry-3F-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 759</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">can_retry?</span> <span class="ruby-identifier">req</span>, <span class="ruby-identifier">retried_on_ruby_2</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@retry_change_requests</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">idempotent?</span>(<span class="ruby-identifier">req</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">retried_on_ruby_2</span>

  <span class="ruby-ivar">@retry_change_requests</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">idempotent?</span>(<span class="ruby-identifier">req</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- can_retry-3F-source -->
            
          </div>

          

          
        </div><!-- can_retry-3F-method -->

      
        <div id="cert-3D-method" class="method-detail method-alias">
          <a name="method-i-cert-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">cert=</span><span
              class="method-args">(certificate)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>For <a href="../HTTP.html">Net::HTTP</a> parity</p>
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Persistent.html#method-i-certificate-3D">certificate=</a>
          </div>
          
        </div><!-- cert-3D-method -->

      
        <div id="cert_store-3D-method" class="method-detail ">
          <a name="method-i-cert_store-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">cert_store=</span><span
              class="method-args">(store)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Overrides the default SSL certificate store used for verifying connections.</p>
            

            
            <div class="method-source-code" id="cert_store-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 556</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cert_store=</span> <span class="ruby-identifier">store</span>
  <span class="ruby-ivar">@cert_store</span> = <span class="ruby-identifier">store</span>

  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- cert_store-3D-source -->
            
          </div>

          

          
        </div><!-- cert_store-3D-method -->

      
        <div id="certificate-3D-method" class="method-detail ">
          <a name="method-i-certificate-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">certificate=</span><span
              class="method-args">(certificate)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets this client's OpenSSL::X509::Certificate</p>
            

            
            <div class="method-source-code" id="certificate-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 534</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">certificate=</span> <span class="ruby-identifier">certificate</span>
  <span class="ruby-ivar">@certificate</span> = <span class="ruby-identifier">certificate</span>

  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- certificate-3D-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Persistent.html#method-i-cert-3D">cert=</a>
          </div>
          

          
        </div><!-- certificate-3D-method -->

      
        <div id="connection_close-3F-method" class="method-detail ">
          <a name="method-i-connection_close-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">connection_close?</span><span
              class="method-args">(header)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Workaround for missing Net::HTTPHeader#connection_close? on Ruby 1.8</p>
            

            
            <div class="method-source-code" id="connection_close-3F-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 769</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">connection_close?</span> <span class="ruby-identifier">header</span>
  <span class="ruby-identifier">header</span>.<span class="ruby-identifier">connection_close?</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- connection_close-3F-source -->
            
          </div>

          

          
        </div><!-- connection_close-3F-method -->

      
        <div id="connection_for-method" class="method-detail ">
          <a name="method-i-connection_for"></a>

          
          <div class="method-heading">
            <span class="method-name">connection_for</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a new connection for <tt>uri</tt></p>
            

            
            <div class="method-source-code" id="connection_for-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 588</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">connection_for</span> <span class="ruby-identifier">uri</span>
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@generation_key</span>]     <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">h</span>,<span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = {} }
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@ssl_generation_key</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">h</span>,<span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = {} }
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@request_key</span>]        <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> <span class="ruby-value">0</span>
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@timeout_key</span>]        <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> <span class="ruby-constant">EPOCH</span>

  <span class="ruby-identifier">use_ssl</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-string">'https'</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_ssl</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Persistent</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">'OpenSSL is not available'</span> <span class="ruby-keyword">unless</span>
      <span class="ruby-constant">HAVE_OPENSSL</span>

    <span class="ruby-identifier">ssl_generation</span> = <span class="ruby-ivar">@ssl_generation</span>

    <span class="ruby-identifier">ssl_cleanup</span> <span class="ruby-identifier">ssl_generation</span>

    <span class="ruby-identifier">connections</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@ssl_generation_key</span>][<span class="ruby-identifier">ssl_generation</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">generation</span> = <span class="ruby-ivar">@generation</span>

    <span class="ruby-identifier">cleanup</span> <span class="ruby-identifier">generation</span>

    <span class="ruby-identifier">connections</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@generation_key</span>][<span class="ruby-identifier">generation</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">net_http_args</span> = [<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>]
  <span class="ruby-identifier">connection_id</span> = <span class="ruby-identifier">net_http_args</span>.<span class="ruby-identifier">join</span> <span class="ruby-string">':'</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@proxy_uri</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">proxy_bypass?</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">connection_id</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@proxy_connection_id</span>
    <span class="ruby-identifier">net_http_args</span>.<span class="ruby-identifier">concat</span> <span class="ruby-ivar">@proxy_args</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">connection</span> = <span class="ruby-identifier">connections</span>[<span class="ruby-identifier">connection_id</span>]

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">connection</span> = <span class="ruby-identifier">connections</span>[<span class="ruby-identifier">connection_id</span>] <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">connections</span>[<span class="ruby-identifier">connection_id</span>] = <span class="ruby-identifier">http_class</span>.<span class="ruby-identifier">new</span>(*<span class="ruby-identifier">net_http_args</span>)
    <span class="ruby-identifier">connection</span> = <span class="ruby-identifier">connections</span>[<span class="ruby-identifier">connection_id</span>]
    <span class="ruby-identifier">ssl</span> <span class="ruby-identifier">connection</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_ssl</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">reset</span> <span class="ruby-identifier">connection</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">expired?</span> <span class="ruby-identifier">connection</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">start</span> <span class="ruby-identifier">connection</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">started?</span>

  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">read_timeout</span> = <span class="ruby-ivar">@read_timeout</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@read_timeout</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">keep_alive_timeout</span> = <span class="ruby-ivar">@idle_timeout</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@idle_timeout</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:keep_alive_timeout=</span>)

  <span class="ruby-identifier">connection</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ECONNREFUSED</span>
  <span class="ruby-identifier">address</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">proxy_address</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">address</span>
  <span class="ruby-identifier">port</span>    = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">proxy_port</span>    <span class="ruby-operator">||</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">port</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;connection refused: #{address}:#{port}&quot;</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EHOSTDOWN</span>
  <span class="ruby-identifier">address</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">proxy_address</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">address</span>
  <span class="ruby-identifier">port</span>    = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">proxy_port</span>    <span class="ruby-operator">||</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">port</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;host down: #{address}:#{port}&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- connection_for-source -->
            
          </div>

          

          
        </div><!-- connection_for-method -->

      
        <div id="connection_keep_alive-3F-method" class="method-detail ">
          <a name="method-i-connection_keep_alive-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">connection_keep_alive?</span><span
              class="method-args">(header)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Workaround for missing Net::HTTPHeader#connection_keep_alive? on Ruby 1.8</p>
            

            
            <div class="method-source-code" id="connection_keep_alive-3F-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 776</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">connection_keep_alive?</span> <span class="ruby-identifier">header</span>
  <span class="ruby-identifier">header</span>.<span class="ruby-identifier">connection_keep_alive?</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- connection_keep_alive-3F-source -->
            
          </div>

          

          
        </div><!-- connection_keep_alive-3F-method -->

      
        <div id="error_message-method" class="method-detail ">
          <a name="method-i-error_message"></a>

          
          <div class="method-heading">
            <span class="method-name">error_message</span><span
              class="method-args">(connection)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns an error message containing the number of requests performed on
this connection</p>
            

            
            <div class="method-source-code" id="error_message-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 653</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">error_message</span> <span class="ruby-identifier">connection</span>
  <span class="ruby-identifier">requests</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@request_key</span>][<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>] <span class="ruby-operator">-</span> <span class="ruby-value">1</span> <span class="ruby-comment"># fixup</span>
  <span class="ruby-identifier">last_use</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@timeout_key</span>][<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>]

  <span class="ruby-identifier">age</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">last_use</span>

  <span class="ruby-node">&quot;after #{requests} requests on #{connection.object_id}, &quot;</span>        <span class="ruby-node">&quot;last used #{age} seconds ago&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- error_message-source -->
            
          </div>

          

          
        </div><!-- error_message-method -->

      
        <div id="escape-method" class="method-detail ">
          <a name="method-i-escape"></a>

          
          <div class="method-heading">
            <span class="method-name">escape</span><span
              class="method-args">(str)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>URI::escape wrapper</p>
            

            
            <div class="method-source-code" id="escape-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 666</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">escape</span> <span class="ruby-identifier">str</span>
  <span class="ruby-constant">CGI</span>.<span class="ruby-identifier">escape</span> <span class="ruby-identifier">str</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">str</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- escape-source -->
            
          </div>

          

          
        </div><!-- escape-method -->

      
        <div id="expired-3F-method" class="method-detail ">
          <a name="method-i-expired-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">expired?</span><span
              class="method-args">(connection)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns true if the connection should be reset due to an idle timeout, or
maximum request count, false otherwise.</p>
            

            
            <div class="method-source-code" id="expired-3F-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 682</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expired?</span> <span class="ruby-identifier">connection</span>
  <span class="ruby-identifier">requests</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@request_key</span>][<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>]
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>  <span class="ruby-keyword">if</span>     <span class="ruby-ivar">@max_requests</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">requests</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@max_requests</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@idle_timeout</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>  <span class="ruby-keyword">if</span>     <span class="ruby-ivar">@idle_timeout</span>.<span class="ruby-identifier">zero?</span>

  <span class="ruby-identifier">last_used</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@timeout_key</span>][<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>]

  <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">last_used</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@idle_timeout</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- expired-3F-source -->
            
          </div>

          

          
        </div><!-- expired-3F-method -->

      
        <div id="finish-method" class="method-detail ">
          <a name="method-i-finish"></a>

          
          <div class="method-heading">
            <span class="method-name">finish</span><span
              class="method-args">(connection, thread = Thread.current)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Finishes the <a href="../HTTP.html">Net::HTTP</a> <tt>connection</tt></p>
            

            
            <div class="method-source-code" id="finish-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 714</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">finish</span> <span class="ruby-identifier">connection</span>, <span class="ruby-identifier">thread</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">requests</span> = <span class="ruby-identifier">thread</span>[<span class="ruby-ivar">@request_key</span>] <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">requests</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">finish</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">IOError</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- finish-source -->
            
          </div>

          

          
        </div><!-- finish-method -->

      
        <div id="http_version-method" class="method-detail ">
          <a name="method-i-http_version"></a>

          
          <div class="method-heading">
            <span class="method-name">http_version</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the <a href="../HTTP.html">HTTP</a> protocol version for
<tt>uri</tt></p>
            

            
            <div class="method-source-code" id="http_version-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 738</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">http_version</span> <span class="ruby-identifier">uri</span>
  <span class="ruby-ivar">@http_versions</span>[<span class="ruby-node">&quot;#{uri.host}:#{uri.port}&quot;</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- http_version-source -->
            
          </div>

          

          
        </div><!-- http_version-method -->

      
        <div id="idempotent-3F-method" class="method-detail ">
          <a name="method-i-idempotent-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">idempotent?</span><span
              class="method-args">(req)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Is <tt>req</tt> idempotent according to RFC 2616?</p>
            

            
            <div class="method-source-code" id="idempotent-3F-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 745</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">idempotent?</span> <span class="ruby-identifier">req</span>
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">req</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Delete</span>, <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Get</span>, <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Head</span>,
       <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span>, <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Put</span>, <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Trace</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- idempotent-3F-source -->
            
          </div>

          

          
        </div><!-- idempotent-3F-method -->

      
        <div id="key-3D-method" class="method-detail method-alias">
          <a name="method-i-key-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">key=</span><span
              class="method-args">(key)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>For <a href="../HTTP.html">Net::HTTP</a> parity</p>
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Persistent.html#method-i-private_key-3D">private_key=</a>
          </div>
          
        </div><!-- key-3D-method -->

      
        <div id="normalize_uri-method" class="method-detail ">
          <a name="method-i-normalize_uri"></a>

          
          <div class="method-heading">
            <span class="method-name">normalize_uri</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Adds "http://" to the String <tt>uri</tt> if it is missing.</p>
            

            
            <div class="method-source-code" id="normalize_uri-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 809</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalize_uri</span> <span class="ruby-identifier">uri</span>
  (<span class="ruby-identifier">uri</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^https?:/</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;http://#{uri}&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalize_uri-source -->
            
          </div>

          

          
        </div><!-- normalize_uri-method -->

      
        <div id="pipeline-method" class="method-detail ">
          <a name="method-i-pipeline"></a>

          
          <div class="method-heading">
            <span class="method-name">pipeline</span><span
              class="method-args">(uri, requests, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Pipelines <tt>requests</tt> to the <a href="../HTTP.html">HTTP</a> server
at <tt>uri</tt> yielding responses if a block is given.  Returns all
responses recieved.</p>

<p>See <a
href="http://docs.seattlerb.org/net-http-pipeline/Net/HTTP/Pipeline.html">Net::HTTP::Pipeline</a>
for further details.</p>

<p>Only if <tt>net-http-pipeline</tt> was required before
<tt>net-http-persistent</tt> <a
href="Persistent.html#method-i-pipeline">pipeline</a> will be present.</p>
            

            
            <div class="method-source-code" id="pipeline-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 824</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pipeline</span> <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">requests</span>, &amp;<span class="ruby-identifier">block</span> <span class="ruby-comment"># :yields: responses</span>
  <span class="ruby-identifier">connection</span> = <span class="ruby-identifier">connection_for</span> <span class="ruby-identifier">uri</span>

  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">pipeline</span> <span class="ruby-identifier">requests</span>, &amp;<span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- pipeline-source -->
            
          </div>

          

          
        </div><!-- pipeline-method -->

      
        <div id="private_key-3D-method" class="method-detail ">
          <a name="method-i-private_key-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">private_key=</span><span
              class="method-args">(key)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets this client's SSL private key</p>
            

            
            <div class="method-source-code" id="private_key-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 833</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">private_key=</span> <span class="ruby-identifier">key</span>
  <span class="ruby-ivar">@private_key</span> = <span class="ruby-identifier">key</span>

  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- private_key-3D-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Persistent.html#method-i-key-3D">key=</a>
          </div>
          

          
        </div><!-- private_key-3D-method -->

      
        <div id="proxy-3D-method" class="method-detail ">
          <a name="method-i-proxy-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">proxy=</span><span
              class="method-args">(proxy)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the proxy server.  The <tt>proxy</tt> may be the URI of the proxy
server, the symbol <tt>:ENV</tt> which will read the proxy from the
environment or nil to disable use of a proxy.  See <a
href="Persistent.html#method-i-proxy_from_env">proxy_from_env</a> for
details on setting the proxy from the environment.</p>

<p>If the proxy URI is set after requests have been made, the next request
will shut-down and re-open all connections.</p>

<p>The <tt>no_proxy</tt> query parameter can be used to specify hosts which
shouldn't be reached via proxy; if set it should be a comma separated list
of hostname suffixes, optionally with <tt>:port</tt> appended, for example
<tt>example.com,some.host:8080</tt>.</p>
            

            
            <div class="method-source-code" id="proxy-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 856</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">proxy=</span> <span class="ruby-identifier">proxy</span>
  <span class="ruby-ivar">@proxy_uri</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">proxy</span>
               <span class="ruby-keyword">when</span> <span class="ruby-value">:ENV</span>      <span class="ruby-keyword">then</span> <span class="ruby-identifier">proxy_from_env</span>
               <span class="ruby-keyword">when</span> <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">proxy</span>
               <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>       <span class="ruby-keyword">then</span> <span class="ruby-comment"># ignore</span>
               <span class="ruby-keyword">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">'proxy must be :ENV or a URI::HTTP'</span>
               <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@no_proxy</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@proxy_uri</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@proxy_args</span> = [
      <span class="ruby-ivar">@proxy_uri</span>.<span class="ruby-identifier">host</span>,
      <span class="ruby-ivar">@proxy_uri</span>.<span class="ruby-identifier">port</span>,
      <span class="ruby-identifier">unescape</span>(<span class="ruby-ivar">@proxy_uri</span>.<span class="ruby-identifier">user</span>),
      <span class="ruby-identifier">unescape</span>(<span class="ruby-ivar">@proxy_uri</span>.<span class="ruby-identifier">password</span>),
    ]

    <span class="ruby-ivar">@proxy_connection_id</span> = [<span class="ruby-keyword">nil</span>, *<span class="ruby-ivar">@proxy_args</span>].<span class="ruby-identifier">join</span> <span class="ruby-string">':'</span>

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@proxy_uri</span>.<span class="ruby-identifier">query</span> <span class="ruby-keyword">then</span>
      <span class="ruby-ivar">@no_proxy</span> = <span class="ruby-constant">CGI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-ivar">@proxy_uri</span>.<span class="ruby-identifier">query</span>)[<span class="ruby-string">'no_proxy'</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">','</span>).<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">','</span>).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">strip</span> }.<span class="ruby-identifier">reject</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">empty?</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">reconnect</span>
  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- proxy-3D-source -->
            
          </div>

          

          
        </div><!-- proxy-3D-method -->

      
        <div id="proxy_bypass-3F-method" class="method-detail ">
          <a name="method-i-proxy_bypass-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">proxy_bypass?</span><span
              class="method-args">(host, port)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns true when proxy should by bypassed for host.</p>
            

            
            <div class="method-source-code" id="proxy_bypass-3F-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 930</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">proxy_bypass?</span> <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>
  <span class="ruby-identifier">host</span> = <span class="ruby-identifier">host</span>.<span class="ruby-identifier">downcase</span>
  <span class="ruby-identifier">host_port</span> = [<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>].<span class="ruby-identifier">join</span> <span class="ruby-string">':'</span>

  <span class="ruby-ivar">@no_proxy</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">host</span>[<span class="ruby-operator">-</span><span class="ruby-identifier">name</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">name</span>.<span class="ruby-identifier">length</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">name</span> <span class="ruby-keyword">or</span>
       <span class="ruby-identifier">host_port</span>[<span class="ruby-operator">-</span><span class="ruby-identifier">name</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">name</span>.<span class="ruby-identifier">length</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">name</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- proxy_bypass-3F-source -->
            
          </div>

          

          
        </div><!-- proxy_bypass-3F-method -->

      
        <div id="proxy_from_env-method" class="method-detail ">
          <a name="method-i-proxy_from_env"></a>

          
          <div class="method-heading">
            <span class="method-name">proxy_from_env</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a URI for an <a href="../HTTP.html">HTTP</a> proxy server from ENV
variables.</p>

<p>If <tt>HTTP_PROXY</tt> is set a proxy will be returned.</p>

<p>If <tt>HTTP_PROXY_USER</tt> or <tt>HTTP_PROXY_PASS</tt> are set the URI is
given the indicated user and password unless HTTP_PROXY contains either of
these in the URI.</p>

<p>The <tt>NO_PROXY</tt> ENV variable can be used to specify hosts which
shouldn't be reached via proxy; if set it should be a comma separated list
of hostname suffixes, optionally with <tt>:port</tt> appended, for example
<tt>example.com,some.host:8080</tt>. When set to <tt>*</tt> no proxy will
be returned.</p>

<p>For Windows users, lowercase ENV variables are preferred over uppercase ENV
variables.</p>
            

            
            <div class="method-source-code" id="proxy_from_env-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 903</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">proxy_from_env</span>
  <span class="ruby-identifier">env_proxy</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">'http_proxy'</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'HTTP_PROXY'</span>]

  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">env_proxy</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">env_proxy</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span> <span class="ruby-identifier">normalize_uri</span> <span class="ruby-identifier">env_proxy</span>

  <span class="ruby-identifier">env_no_proxy</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">'no_proxy'</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'NO_PROXY'</span>]

  <span class="ruby-comment"># '*' is special case for always bypass</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">env_no_proxy</span> <span class="ruby-operator">==</span> <span class="ruby-string">'*'</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">env_no_proxy</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span> = <span class="ruby-node">&quot;no_proxy=#{escape(env_no_proxy)}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span>     = <span class="ruby-identifier">escape</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'http_proxy_user'</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'HTTP_PROXY_USER'</span>]
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span> = <span class="ruby-identifier">escape</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'http_proxy_pass'</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'HTTP_PROXY_PASS'</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">uri</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- proxy_from_env-source -->
            
          </div>

          

          
        </div><!-- proxy_from_env-method -->

      
        <div id="reconnect-method" class="method-detail ">
          <a name="method-i-reconnect"></a>

          
          <div class="method-heading">
            <span class="method-name">reconnect</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Forces reconnection of <a href="../HTTP.html">HTTP</a> connections.</p>
            

            
            <div class="method-source-code" id="reconnect-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 945</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reconnect</span>
  <span class="ruby-ivar">@generation</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- reconnect-source -->
            
          </div>

          

          
        </div><!-- reconnect-method -->

      
        <div id="reconnect_ssl-method" class="method-detail ">
          <a name="method-i-reconnect_ssl"></a>

          
          <div class="method-heading">
            <span class="method-name">reconnect_ssl</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Forces reconnection of SSL connections.</p>
            

            
            <div class="method-source-code" id="reconnect_ssl-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 952</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reconnect_ssl</span>
  <span class="ruby-ivar">@ssl_generation</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- reconnect_ssl-source -->
            
          </div>

          

          
        </div><!-- reconnect_ssl-method -->

      
        <div id="request-method" class="method-detail ">
          <a name="method-i-request"></a>

          
          <div class="method-heading">
            <span class="method-name">request</span><span
              class="method-args">(uri, req = nil, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Makes a request on <tt>uri</tt>.  If <tt>req</tt> is nil a Net::HTTP::Get
is performed against <tt>uri</tt>.</p>

<p>If a block is passed <a href="Persistent.html#method-i-request">request</a>
behaves like Net::HTTP#request (the body of the response will not have been
read).</p>

<p><tt>req</tt> must be a Net::HTTPRequest subclass (see <a
href="../HTTP.html">Net::HTTP</a> for a list).</p>

<p>If there is an error and the request is idempotent according to RFC 2616 it
will be retried automatically.</p>
            

            
            <div class="method-source-code" id="request-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 988</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">request</span> <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">req</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">retried</span>      = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">bad_response</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-identifier">req</span> = <span class="ruby-identifier">request_setup</span> <span class="ruby-identifier">req</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">uri</span>

  <span class="ruby-identifier">connection</span> = <span class="ruby-identifier">connection_for</span> <span class="ruby-identifier">uri</span>
  <span class="ruby-identifier">connection_id</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@request_key</span>][<span class="ruby-identifier">connection_id</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">response</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span> <span class="ruby-identifier">req</span>, &amp;<span class="ruby-identifier">block</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">connection_close?</span>(<span class="ruby-identifier">req</span>) <span class="ruby-keyword">or</span>
       (<span class="ruby-identifier">response</span>.<span class="ruby-identifier">http_version</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-string">'1.0'</span> <span class="ruby-keyword">and</span>
        <span class="ruby-keyword">not</span> <span class="ruby-identifier">connection_keep_alive?</span>(<span class="ruby-identifier">response</span>)) <span class="ruby-keyword">or</span>
       <span class="ruby-identifier">connection_close?</span>(<span class="ruby-identifier">response</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">finish</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPBadResponse</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">message</span> = <span class="ruby-identifier">error_message</span> <span class="ruby-identifier">connection</span>

    <span class="ruby-identifier">finish</span> <span class="ruby-identifier">connection</span>

    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;too many bad responses #{message}&quot;</span> <span class="ruby-keyword">if</span>
      <span class="ruby-identifier">bad_response</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">can_retry?</span> <span class="ruby-identifier">req</span>

    <span class="ruby-identifier">bad_response</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">rescue</span> *<span class="ruby-constant">RETRIED_EXCEPTIONS</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span> <span class="ruby-comment"># retried on ruby 2</span>
    <span class="ruby-identifier">request_failed</span> <span class="ruby-identifier">e</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">connection</span> <span class="ruby-keyword">if</span>
      <span class="ruby-identifier">retried</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">can_retry?</span> <span class="ruby-identifier">req</span>, <span class="ruby-ivar">@retried_on_ruby_2</span>

    <span class="ruby-identifier">reset</span> <span class="ruby-identifier">connection</span>

    <span class="ruby-identifier">retried</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EINVAL</span>, <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ETIMEDOUT</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span> <span class="ruby-comment"># not retried on ruby 2</span>
    <span class="ruby-identifier">request_failed</span> <span class="ruby-identifier">e</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">connection</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">retried</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">can_retry?</span> <span class="ruby-identifier">req</span>

    <span class="ruby-identifier">reset</span> <span class="ruby-identifier">connection</span>

    <span class="ruby-identifier">retried</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">finish</span> <span class="ruby-identifier">connection</span>

    <span class="ruby-identifier">raise</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@timeout_key</span>][<span class="ruby-identifier">connection_id</span>] = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@http_versions</span>[<span class="ruby-node">&quot;#{uri.host}:#{uri.port}&quot;</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">http_version</span>

  <span class="ruby-identifier">response</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- request-source -->
            
          </div>

          

          
        </div><!-- request-method -->

      
        <div id="reset-method" class="method-detail ">
          <a name="method-i-reset"></a>

          
          <div class="method-heading">
            <span class="method-name">reset</span><span
              class="method-args">(connection)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Finishes then restarts the <a href="../HTTP.html">Net::HTTP</a>
<tt>connection</tt></p>
            

            
            <div class="method-source-code" id="reset-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 959</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reset</span> <span class="ruby-identifier">connection</span>
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@request_key</span>].<span class="ruby-identifier">delete</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-ivar">@timeout_key</span>].<span class="ruby-identifier">delete</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">object_id</span>

  <span class="ruby-identifier">finish</span> <span class="ruby-identifier">connection</span>

  <span class="ruby-identifier">start</span> <span class="ruby-identifier">connection</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ECONNREFUSED</span>
  <span class="ruby-identifier">e</span> = <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span> <span class="ruby-node">&quot;connection refused: #{connection.address}:#{connection.port}&quot;</span>
  <span class="ruby-identifier">e</span>.<span class="ruby-identifier">set_backtrace</span> <span class="ruby-identifier">$@</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EHOSTDOWN</span>
  <span class="ruby-identifier">e</span> = <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span> <span class="ruby-node">&quot;host down: #{connection.address}:#{connection.port}&quot;</span>
  <span class="ruby-identifier">e</span>.<span class="ruby-identifier">set_backtrace</span> <span class="ruby-identifier">$@</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- reset-source -->
            
          </div>

          

          
        </div><!-- reset-method -->

      
        <div id="shutdown-method" class="method-detail ">
          <a name="method-i-shutdown"></a>

          
          <div class="method-heading">
            <span class="method-name">shutdown</span><span
              class="method-args">(thread = Thread.current)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Shuts down all connections for <tt>thread</tt>.</p>

<p>Uses the current thread by default.</p>

<p>If you've used <a href="Persistent.html">Net::HTTP::Persistent</a> across
multiple threads you should call this in each thread when you're done
making <a href="../HTTP.html">HTTP</a> requests.</p>

<p><b>NOTE</b>: Calling shutdown for another thread can be dangerous!</p>

<p>If the thread is still using the connection it may cause an error!  It is
best to call <a href="Persistent.html#method-i-shutdown">shutdown</a> in
the thread at the appropriate time instead!</p>
            

            
            <div class="method-source-code" id="shutdown-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 1103</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">shutdown</span> <span class="ruby-identifier">thread</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>
  <span class="ruby-identifier">generation</span> = <span class="ruby-identifier">reconnect</span>
  <span class="ruby-identifier">cleanup</span> <span class="ruby-identifier">generation</span>, <span class="ruby-identifier">thread</span>, <span class="ruby-ivar">@generation_key</span>

  <span class="ruby-identifier">ssl_generation</span> = <span class="ruby-identifier">reconnect_ssl</span>
  <span class="ruby-identifier">cleanup</span> <span class="ruby-identifier">ssl_generation</span>, <span class="ruby-identifier">thread</span>, <span class="ruby-ivar">@ssl_generation_key</span>

  <span class="ruby-identifier">thread</span>[<span class="ruby-ivar">@request_key</span>] = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">thread</span>[<span class="ruby-ivar">@timeout_key</span>] = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- shutdown-source -->
            
          </div>

          

          
        </div><!-- shutdown-method -->

      
        <div id="shutdown_in_all_threads-method" class="method-detail ">
          <a name="method-i-shutdown_in_all_threads"></a>

          
          <div class="method-heading">
            <span class="method-name">shutdown_in_all_threads</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Shuts down all connections in all threads</p>

<p><b>NOTE</b>: THIS METHOD IS VERY DANGEROUS!</p>

<p>Do not call this method if other threads are still using their connections!
Call <a href="Persistent.html#method-i-shutdown">shutdown</a> at the
appropriate time instead!</p>

<p>Use this method only as a last resort!</p>
            

            
            <div class="method-source-code" id="shutdown_in_all_threads-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 1124</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">shutdown_in_all_threads</span>
  <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">shutdown</span> <span class="ruby-identifier">thread</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- shutdown_in_all_threads-source -->
            
          </div>

          

          
        </div><!-- shutdown_in_all_threads-method -->

      
        <div id="ssl-method" class="method-detail ">
          <a name="method-i-ssl"></a>

          
          <div class="method-heading">
            <span class="method-name">ssl</span><span
              class="method-args">(connection)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Enables SSL on <tt>connection</tt></p>
            

            
            <div class="method-source-code" id="ssl-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 1135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ssl</span> <span class="ruby-identifier">connection</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">use_ssl</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">ssl_version</span> = <span class="ruby-ivar">@ssl_version</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@ssl_version</span>

  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-ivar">@verify_mode</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_PEER</span> <span class="ruby-operator">==</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_NONE</span> <span class="ruby-keyword">and</span>
     <span class="ruby-keyword">not</span> <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_defined?</span>(<span class="ruby-value">:I_KNOW_THAT_OPENSSL_VERIFY_PEER_EQUALS_VERIFY_NONE_IS_WRONG</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-string">                             !!!SECURITY WARNING!!!The SSL HTTP connection to:  #{connection.address}:#{connection.port}                           !!!MAY NOT BE VERIFIED!!!On your platform your OpenSSL implementation is broken.There is no difference between the values of VERIFY_NONE and VERIFY_PEER.This means that attempting to verify the security of SSL connections may notwork.  This exposes you to man-in-the-middle exploits, snooping on thecontents of your connection and other dangers to the security of your data.To disable this warning define the following constant at top-level in yourapplication:  I_KNOW_THAT_OPENSSL_VERIFY_PEER_EQUALS_VERIFY_NONE_IS_WRONG = nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@ca_file</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">ca_file</span> = <span class="ruby-ivar">@ca_file</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_PEER</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">verify_callback</span> = <span class="ruby-ivar">@verify_callback</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@verify_callback</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@certificate</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@private_key</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">cert</span> = <span class="ruby-ivar">@certificate</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">key</span>  = <span class="ruby-ivar">@private_key</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">cert_store</span> = <span class="ruby-keyword">if</span> <span class="ruby-ivar">@cert_store</span> <span class="ruby-keyword">then</span>
                            <span class="ruby-ivar">@cert_store</span>
                          <span class="ruby-keyword">else</span>
                            <span class="ruby-identifier">store</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">X509</span><span class="ruby-operator">::</span><span class="ruby-constant">Store</span>.<span class="ruby-identifier">new</span>
                            <span class="ruby-identifier">store</span>.<span class="ruby-identifier">set_default_paths</span>
                            <span class="ruby-identifier">store</span>
                          <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- ssl-source -->
            
          </div>

          

          
        </div><!-- ssl-method -->

      
        <div id="ssl_version-3D-method" class="method-detail ">
          <a name="method-i-ssl_version-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">ssl_version=</span><span
              class="method-args">(ssl_version)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>SSL version to use</p>
            

            
            <div class="method-source-code" id="ssl_version-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 1200</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ssl_version=</span> <span class="ruby-identifier">ssl_version</span>
  <span class="ruby-ivar">@ssl_version</span> = <span class="ruby-identifier">ssl_version</span>

  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- ssl_version-3D-source -->
            
          </div>

          

          
        </div><!-- ssl_version-3D-method -->

      
        <div id="start-method" class="method-detail ">
          <a name="method-i-start"></a>

          
          <div class="method-heading">
            <span class="method-name">start</span><span
              class="method-args">(connection)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Starts the <a href="../HTTP.html">Net::HTTP</a> <tt>connection</tt></p>
            

            
            <div class="method-source-code" id="start-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 696</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">start</span> <span class="ruby-identifier">connection</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">set_debug_output</span> <span class="ruby-ivar">@debug_output</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@debug_output</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">open_timeout</span> = <span class="ruby-ivar">@open_timeout</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@open_timeout</span>

  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">start</span>

  <span class="ruby-identifier">socket</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">instance_variable_get</span> <span class="ruby-value">:@socket</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">socket</span> <span class="ruby-keyword">then</span> <span class="ruby-comment"># for fakeweb</span>
    <span class="ruby-ivar">@socket_options</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">option</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">socket</span>.<span class="ruby-identifier">io</span>.<span class="ruby-identifier">setsockopt</span>(*<span class="ruby-identifier">option</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- start-source -->
            
          </div>

          

          
        </div><!-- start-method -->

      
        <div id="unescape-method" class="method-detail ">
          <a name="method-i-unescape"></a>

          
          <div class="method-heading">
            <span class="method-name">unescape</span><span
              class="method-args">(str)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>URI::unescape wrapper</p>
            

            
            <div class="method-source-code" id="unescape-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 673</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unescape</span> <span class="ruby-identifier">str</span>
  <span class="ruby-constant">CGI</span>.<span class="ruby-identifier">unescape</span> <span class="ruby-identifier">str</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">str</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- unescape-source -->
            
          </div>

          

          
        </div><!-- unescape-method -->

      
        <div id="verify_callback-3D-method" class="method-detail ">
          <a name="method-i-verify_callback-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">verify_callback=</span><span
              class="method-args">(callback)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>SSL verification callback.</p>
            

            
            <div class="method-source-code" id="verify_callback-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 1222</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">verify_callback=</span> <span class="ruby-identifier">callback</span>
  <span class="ruby-ivar">@verify_callback</span> = <span class="ruby-identifier">callback</span>

  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- verify_callback-3D-source -->
            
          </div>

          

          
        </div><!-- verify_callback-3D-method -->

      
        <div id="verify_mode-3D-method" class="method-detail ">
          <a name="method-i-verify_mode-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">verify_mode=</span><span
              class="method-args">(verify_mode)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the HTTPS verify mode.  Defaults to OpenSSL::SSL::VERIFY_PEER.</p>

<p>Setting this to VERIFY_NONE is a VERY BAD IDEA and should NEVER be used.
Securely transfer the correct certificate and update the default
certificate store or set the ca file instead.</p>
            

            
            <div class="method-source-code" id="verify_mode-3D-source">
<pre>
<span class="ruby-comment"># File lib/bundler/vendor/net/http/persistent.rb, line 1213</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">verify_mode=</span> <span class="ruby-identifier">verify_mode</span>
  <span class="ruby-ivar">@verify_mode</span> = <span class="ruby-identifier">verify_mode</span>

  <span class="ruby-identifier">reconnect_ssl</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- verify_mode-3D-source -->
            
          </div>

          

          
        </div><!-- verify_mode-3D-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

